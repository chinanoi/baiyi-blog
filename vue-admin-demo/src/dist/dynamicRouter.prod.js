"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _router=_interopRequireDefault(require("./router")),_Home=_interopRequireDefault(require("@/components/common/Home.vue")),_menu=_interopRequireDefault(require("@/router/menu.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function ownKeys(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,o)}return r}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(r,!0).forEach(function(e){_defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(r).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var getRouter,_import=require("./router/_import_"+process.env.NODE_ENV);function initRouter(){_router.default.beforeEach(function(e,t,r){sessionStorage.getItem("getRouter")?r():(getRouter=_menu.default.data.router,sessionStorage.setItem("getRouter",getRouter),saveObjArr("router",getRouter),routerGo(e,r))})}function getData(){var n=[{path:"/",redirect:"/dashboard"},{path:"/",component:"home",children:[{path:"/dashboard",component:"page/Dashboard",icon:"el-icon-lx-home",index:"dashboard",title:"平台首页",meta:{title:"平台首页"}},{path:"/404",component:"page/404",meta:{title:"页面不存在"}}]},{path:"*",redirect:"/404"}],e=JSON.parse(sessionStorage.getItem("menu"));if(e){var t=[],u=[];e.forEach(function(e){null===e.parentModuleId?t.push(e):u.push(e)}),t.forEach(function(t,e){var r=0,o={};o=null==t.url||""==t.url?{path:"/Dashboard",component:"page/Dashboard",icon:null==t.icon||""==t.icon?"el-icon-lx-home":t.icon,index:e.toString(),title:t.moduleName}:{path:"/"+t.url.substring(t.url.lastIndexOf("/")+1),component:t.url,icon:null==t.icon||""==t.icon?"el-icon-lx-home":t.icon,index:t.url.substring(t.url.lastIndexOf("/")+1),title:t.moduleName},0<u.length?u.forEach(function(e){r++,t.moduleId===e.parentModuleId&&(n[1].children.push({path:"/"+e.url.substring(e.url.lastIndexOf("/")+1),component:e.url,meta:{title:e.moduleName,icon:null==t.icon||""==t.icon?"el-icon-lx-home":t.icon}}),o.subs||(o.subs=[]),o.subs.push({index:e.url.substring(e.url.lastIndexOf("/")+1),title:e.moduleName})),r===u.length&&n[1].children.push(o)}):n[1].children.push(o)})}return n}function routerGo(e,t){var r=JSON.parse(window.sessionStorage.router);getRouter=filterAsyncRouter(r),_router.default.addRoutes(getRouter),global.antRouter=getRouter[1].children,t(_objectSpread({},e,{replace:!0}))}function saveObjArr(e,t){sessionStorage.setItem(e,JSON.stringify(t))}function getObjArr(e){return window.sessionStorage.getItem(e)}function filterAsyncRouter(e){var t=require.context("@/components",!0,/\.vue/);return e.filter(function(e){var r=!1;if(e.component)if("home"===e.component)e.component=_Home.default;else{var o=e.path.slice(1);if(t.keys().forEach(function(e){var t=e.split("/");t=t[t.length-1].split(".")[0];validateFileName(e);o.toLowerCase()===t.toLowerCase()&&(r=!0)}),!r)return!1;e.component=_import(e.component)}return e.children&&e.children.length&&(e.children=filterAsyncRouter(e.children)),!0})}function validateFileName(e){return/^\S+\.vue$/.test(e)&&e.replace(/^\S+\/(\w+)\.vue$/,function(e,t){return capitalizeFirstLetter(t)})}function capitalizeFirstLetter(e){return e.charAt(0)+e.slice(1)}var _default={initRouter:initRouter,filterAsyncRouter:filterAsyncRouter};exports.default=_default;